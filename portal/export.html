<section>
      <div id=toolbar__ID>
            <a id=back__ID>Back</a>
            <input placeholder='table ID' id=tid__ID type=text />
            <input placeholder='filter' id=keyword__ID type=text /> <a id=query__ID>Load</a>
            <span class=tab__ID ></span>Page Size: <select id=page_size__ID><option>30</option><option>50</option><option>100</option><option>200</option></select><span class=tab__ID></span>
            <span id=I__ID style="display:none">0</span><span id=A__ID></span>
            <img id=p__ID src="__BASE__/vmiis/Common-Code/image/p.png" ><img id=n__ID src="__BASE__/vmiis/Common-Code/image/n.png" >
            <span class=tab__ID></span><span class=tab__ID></span>
            <span class=tab__ID></span>Start page: <input id=start__ID type=text style="width:45px" />
            Number of page: <input id=num__ID type=text  style="width:45px" />
            <a id=export__ID>Export</a>
      </div>
      <div id=table__ID>
          <table id=grid__ID></table>
      </div>
</section>
<script>
    function F__ID(){
        //-------------------------------------
        VmInclude:__BASE__/vmiis/Common-Code/grid/grid2.js
        VmInclude:__BASE__/vmiis/Common-Code/style/ease-in-out.js
        //-------------------------------------
        var fields="";
        //-------------------------------------
        $('#D__ID').on('load',function(){
            var table_id=$vm.vm['__ID'].op.table_id;
            if(table_id!=undefined){
                $('#tid__ID').val(table_id);
                _set_req(); _request_data();
            }
        })
        //-------------------------------------
        _set_req=function(){
            _db_pid=$('#tid__ID').val();
            _filename='T'+_db_pid+'.csv';
            if(_db_pid==''){
                alert("Please select a table ID.");
                return false;
            }
            var sql="with tb as (select ID,Information,DateTime,Author,RowNum=row_number() over (order by ID DESC)";
            sql+=" from [TABLE-"+_db_pid+"-@S1] )";
            sql+="select ID,Information,DateTime,Author from tb where RowNum between @I6 and @I7";
            var sql_n="select count(ID) from [TABLE-"+_db_pid+"-@S1]";
            _req={cmd:'query_records',sql:sql,sql_n:sql_n,s1:'"'+$('#keyword__ID').val()+'"',I:$('#I__ID').text(),page_size:$('#page_size__ID').val()}
        }
        //-------------------------------------
        _before_submit=function(record,dbv){
            var r=confirm("Warning!!! Data entry without validation may cause some applications not working properly! Please use a related application module to add or modify the data.This module is ideally used to search, view, delete or export data.")
            return r;
        };
        //-------------------------------------
        _new_process=function(){
            if(fields==""){
                alert("The table doesn't exist.");
                return false;
            }
        }
        //-------------------------------------
        _data_process=function(){
            var all_headers=[];
            fields="";
            for(var i=0;i<_records.length;i++){
                var record=_records[i];
                for (var key in record) {
                    if (record.hasOwnProperty(key)) {
                        if($.inArray(key, all_headers)==-1){
                            all_headers.push(key);
                            if(fields!="") fields+=",";
                            fields+=key;
                        }
                    }
                }
            }
            fields=fields.replace('ID,','');
            fields=fields.replace(',DateTime','');
            fields=fields.replace(',Author','');
            _fields="_Form,"+fields+",Submit Date|DateTime,Submitted by|Author,_Delete";
        }
        //-------------------------------------
    }
</script>
<style>
    VmInclude:__BASE__/vmiis/Common-Code/grid/grid.css
</style>
