<div id=D__ID>
    <div>
        VmInclude:__COMPONENT__/g/grid.365.01.html
    </div>
    <script>
        function F__ID(){
            //-------------------------------------
            VmInclude:__COMPONENT__/g/grid.365.01.js
            //-------------------------------------
            var fields="Title,First_name,Last_name,Phone";
            m.fields="_Form,"+fields;//+",Submit_date,Submitted_by,_Delete";
            m.fields_e=fields;
            $('#title__ID').text("contact_list");
            //-------------------------------------
            m.data_process=function(data){
                m.records=[];
                for(var i=0;i<data.length;i++){
                    m.records.push({
                        //"_id":data[i]['@odata.id'],
                        "_id":data[i]['ID'],
                        /*
                        "Submit_date":data[i].createdon,
                        "Submitted_by":data[i].createdby.firstname+" "+data[i].createdby.lastname,
                        */
                        Data:{
                            "Title":data[i].Title,
                            "First_name":data[i].First_name,
                            "Last_name":data[i].Last_name,
                            "Phone":data[i].Phone,
                        }
                    })
                }
            }
            //-------------------------------------
            /*
            m.set_req=function(){
                m.req="/api/data/v9.1/"+m.Table+"?$expand=createdby($select=firstname,lastname)";
            }
            */
            //-------------------------------------
            m.select="$select=Title";
            m.set_req=function(){
                m.endpoint=$vm.m365.sharepointURI;
                //m.req="/_api/web/lists('91f21b67-cf51-4311-b5de-b212f3bb85bb')/items$top=10"; not working
                m.req="/_api/web/lists/getbytitle('contact_list')/items";
                
                /*
                var k=$('#keyword__ID').val();
                if(k!=""){
                    var n=k.split(':')[0];
                    var v=k.split(':').pop();
                    if(k!="") m.req+="&$filter=contains("+n+",'"+v+"')";
                }
                */
                //if(m.select!="") m.req+="&"+m.select;
            }
            //-------------------------------------

        }
    </script>
    <style>
        VmInclude:__COMPONENT__/g/grid.01.css
    </style>
</div>
